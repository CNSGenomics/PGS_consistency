<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Whole Genome Sequencing data</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PGS|Consistency</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">Introduction</a>
</li>
<li>
  <a href="0_PredictorPrep.html">Predictors</a>
</li>
<li>
  <a href="1_GRP_ChipData.html">HSU Data</a>
</li>
<li>
  <a href="2_QIMR_ChipData.html">QIMR Data</a>
</li>
<li>
  <a href="3_WGS.html">WGS data</a>
</li>
<li>
  <a href="4_LowPassSeq.html">lcWGS data</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Whole Genome Sequencing data</h1>

</div>


<div id="data-resource" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Data resource</h1>
<p>High coverage whole genome sequencing data was downloaded from the
1000 Genomes project.</p>
<p><a href="https://www.internationalgenome.org/data-portal/sample"
class="uri">https://www.internationalgenome.org/data-portal/sample</a></p>
<p>citation: Marta Byrska-Bishop et al., High-coverage whole-genome
sequencing of the expanded 1000 Genomes Project cohort including 602
trios<br />
<a
href="https://www.cell.com/cell/fulltext/S0092-8674(22)00991-6#sectitle0030"
class="uri">https://www.cell.com/cell/fulltext/S0092-8674(22)00991-6#sectitle0030</a></p>
<pre class="bash"><code>
## downloaded cram file 
ftp://ftp.sra.ebi.ac.uk/vol1/run/ERR398/ERR3989270/NA07029.final.cram 
ftp://ftp.sra.ebi.ac.uk/vol1/run/ERR398/ERR3989266/NA06997.final.cram
ftp://ftp.sra.ebi.ac.uk/vol1/run/ERR398/ERR3989299/NA10861.final.cram   

## index the files
samtools index -b ${sample}.final.cram
</code></pre>
<p>The files are alignment files, which were alighed against the human
genome build 38.</p>
</div>
<div id="process-wgs-data" class="section level1" number="2">
<h1><span class="header-section-number">2</span> process WGS data</h1>
<div id="call-variants" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> call variants</h2>
<p>Alignment files are processed to call variants at BP resolution using
GATK best practice.</p>
<pre class="bash"><code>
i=$SLURM_ARRAY_TASK_ID
module load bcftools
samples=(&quot;NA06997&quot; &quot;NA07029&quot; &quot;NA10861&quot;)

for samples in &quot;${samples[@]}&quot;; do
# call variants
Pipelines/gatk-4.1.9.0/gatk HaplotypeCaller  \
-R $ref  \
-I  withBuild38/Alighed_bam/${sample}.final.cram   \
--dbsnp  Pipelines/hg38/dbsnp_146.hg38.vcf.gz  \
--emit-ref-confidence BP_RESOLUTION     \
-O  withBuild38/Called_Variants/ref_confidence_BP_resolution/${sample}_dbSNP_from1KG_chr${i}.vcf.gz     \
-L  chr${i}

## separate multiallelic into rows
bcftools norm -m - withBuild38/Called_Variants/ref_confidence_BP_resolution/${sample}_dbSNP_from1KG_chr${i}.vcf.gz  &gt;  withBuild38/Called_Variants/ref_confidence_BP_resolution/${sample}_dbSNP_biallelic_from1KG_chr${i}.vcf.gz
done</code></pre>
</div>
<div id="annotate-snps" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Annotate SNPs</h2>
<p>Although we used the annotate option in GATK with <em>–dbsnp
Pipelines/hg38/dbsnp_146.hg38.vcf.gz</em>, due to the limit of samples
in allele coverage, most of the SNPs are not annotated properly. We will
have to annotate them based on the alleles pairs in our predictors.</p>
<pre class="bash"><code>
#https://www.biostars.org/p/9554277/
wget -c ftp://gsapubftp-anonymous@ftp.broadinstitute.org/bundle/hg38/dbsnp_146.hg38.vcf.gz
wget -c ftp://gsapubftp-anonymous@ftp.broadinstitute.org/bundle/hg38/dbsnp_146.hg38.vcf.gz.tbi

grep rs  Pipelines/HRC.r1-1.GRCh37.wgs.mac5.sites.tab  | awk &#39;{print $3}&#39;  &gt; HRC.SNPs.with.dbSNP.IDs.txt

zless  Pipelines/hg38/dbsnp_146.hg38.vcf.gz  | grep -w -f HRC.SNPs.with.dbSNP.IDs.txt  &gt; ../SNP_lists/dbsnp_146.hg38_in_HRCpanel.txt</code></pre>
<p>Since we have only one sample in each VCF file, we are going to do
annotation by reading it into R.</p>
<pre class="bash"><code>i=$SLURM_ARRAY_TASK_ID

sample=&quot;NA06997&quot;
target=${sample}_dbSNP_biallelic_from1KG_chr${i}

zless  withBuild38/Called_Variants/ref_confidence_BP_resolution/${target}.vcf.gz  &gt; ${target}.vcf
grep &quot;^#&quot; ${target}.vcf  &gt; ${target}.vcf.header
Rscript  annotate_vcf_updated.R  ${sample} ${i}
cat ${target}.vcf.header  ${target}.vcf_annotated.txt  &gt; ${target}_annotated.vcf
</code></pre>
<p>This is the R script to annotate SNPs.</p>
<pre class="r"><code>## this is annotate_vcf_updated.R
#setwd(&quot;/scratch/project_mnt/S0007/uqtlin5/CEPH_samples/WGS&quot;)

args=commandArgs(trailingOnly = TRUE)
library(data.table)
sample=args[1]
chr=args[2]

#sample=&quot;NA06997&quot;
#chr=22

info.file = &quot;/QRISdata/Q6913/Pipeline/ukb20k_7M_4cM/snp.info&quot;
info = data.frame(fread(info.file))

geno.file =  paste0( sample, &quot;_dbSNP_biallelic_from1KG_chr&quot;, chr, &quot;.vcf&quot;)
dbsnp.file =  paste0(&quot;SNP_lists/&quot;, &quot;dbsnp_146.hg38_in_HRC_chr&quot;, chr,&quot;.txt&quot;)

geno = read.table(geno.file)
dbsnp = read.table(dbsnp.file)

geno$chr_pos = paste0(geno$V1, &quot;_&quot;, geno$V2)
dbsnp$chr_pos = paste0(dbsnp$V1, &quot;_&quot;, dbsnp$V2)

geno$A1.in.dbsnp = dbsnp[match(geno$chr_pos, dbsnp$chr_pos), &quot;V4&quot;]
geno$A2.in.dbsnp = dbsnp[match(geno$chr_pos, dbsnp$chr_pos), &quot;V5&quot;]
geno$rsID = dbsnp[match(geno$chr_pos, dbsnp$chr_pos), &quot;V3&quot;]

geno$A1.in.pred = info[match(geno$rsID, info$ID),&quot;A1&quot;]
geno$A2.in.pred = info[match(geno$rsID, info$ID),&quot;A2&quot;]

## keep useful geno
geno = geno[geno$rsID%in%info$ID,]

## with alt SNPs
geno.group2 = geno[which(geno$V5 != &quot;&lt;NON_REF&gt;&quot;), ]
selected.geno.group2 = geno.group2[( (geno.group2[,&quot;V4&quot;] == geno.group2[, &quot;A1.in.pred&quot;] ) &amp;  
                                       (geno.group2[,&quot;V5&quot;] == geno.group2[, &quot;A2.in.pred&quot;] ))|
                                   ( (geno.group2[,&quot;V4&quot;] == geno.group2[, &quot;A2.in.pred&quot;] ) &amp;  
                                       (geno.group2[,&quot;V5&quot;] == geno.group2[, &quot;A1.in.pred&quot;] ))
                                   ,]

## non alt SNPs
geno.group1 = geno[which(geno$V5 == &quot;&lt;NON_REF&gt;&quot; &amp; geno$V4 ==geno$A1.in.pred ),]
geno.group1 = geno.group1[ !geno.group1$rsID %in% selected.geno.group2$rsID ,]
geno.group1$V5 = geno.group1$A2.in.pred

geno.group3 = geno[which(geno$V5 == &quot;&lt;NON_REF&gt;&quot; &amp; geno$V4 ==geno$A2.in.pred),]
geno.group3 = geno.group3[ !geno.group3$rsID %in% selected.geno.group2$rsID ,]
geno.group3$V5 = geno.group3$A1.in.pred

## merge back
ant.geno = rbind(geno.group1, selected.geno.group2, geno.group3)
sort.geno= ant.geno[order(ant.geno$V2),]

write.table(sort.geno[,c(&quot;V1&quot;, &quot;V2&quot;, &quot;rsID&quot;, &quot;V4&quot;, &quot;V5&quot;, &quot;V6&quot;, &quot;V7&quot;, &quot;V8&quot;, &quot;V9&quot;, &quot;V10&quot;)], paste0(geno.file, &quot;_annotated.txt&quot; ), quote = F, sep =&quot;\t&quot;, row.names = F, col.names = F)</code></pre>
<p>Some SNPs in our 7.3M SBayesRC predictors can’t be detected in the
few WGS data, lacking proper alleles.</p>
<p>Example of missing SNP:</p>
<pre class="r"><code> geno[which(geno$rsID== &quot;rs242078&quot;),]
#             V1       V2       V3        V4        V5     V6 V7
# 32897331 chr22 32832706 rs242078 ATAATACTT         A 335.64  .
# 32897332 chr22 32832706 rs242078 ATAATACTT GTAATACTT 335.64  .
# 32897333 chr22 32832706 rs242078 ATAATACTT &lt;NON_REF&gt; 335.64  .
#                                                                                                                              V8
# 32897331   BaseQRankSum=-0.933;DB;DP=36;ExcessHet=3.0103;MLEAC=0;MLEAF=0;MQRankSum=0;RAW_MQandDP=129600,36;ReadPosRankSum=0.166
# 32897332 BaseQRankSum=-0.933;DB;DP=36;ExcessHet=3.0103;MLEAC=1;MLEAF=0.5;MQRankSum=0;RAW_MQandDP=129600,36;ReadPosRankSum=0.166
# 32897333   BaseQRankSum=-0.933;DB;DP=36;ExcessHet=3.0103;MLEAC=0;MLEAF=0;MQRankSum=0;RAW_MQandDP=129600,36;ReadPosRankSum=0.166
#                         V9                                 V10        chr_pos
# 32897331 GT:AD:DP:GQ:PL:SB 0/0:15,0:30:99:343,430,1302:9,6,9,6 chr22_32832706
# 32897332 GT:AD:DP:GQ:PL:SB   0/1:15,13:30:99:343,0,438:9,6,9,6 chr22_32832706
# 32897333 GT:AD:DP:GQ:PL:SB 0/0:15,2:30:99:343,422,1130:9,6,9,6 chr22_32832706
#          A1.in.dbsnp A2.in.dbsnp     rsID A1.in.pred A2.in.pred
# 32897331           A           G rs242078          G          A
# 32897332           A           G rs242078          G          A
# 32897333           A           G rs242078          G          A</code></pre>
</div>
<div id="merge-chromosomes" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> merge
chromosomes</h2>
<p>The annotated chromosomes of each data are merged into one vcf
file.</p>
<pre class="bash"><code>
module load vcftools 
samples=(&quot;NA06997&quot; &quot;NA07029&quot; &quot;NA10861&quot;)
for sample in &quot;${samples[@]}&quot;; do
vcf-concat  ${sample}_dbSNP_biallelic_from1KG_chr1_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr2_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr3_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr4_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr5_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr6_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr7_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr8_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr9_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr10_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr11_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr12_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr13_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr14_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr15_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr16_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr17_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr18_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr19_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr20_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr21_annotated.vcf \
            ${sample}_dbSNP_biallelic_from1KG_chr22_annotated.vcf \
             &gt; ${sample}_combined_SBRC_SNPs.vcf
done
</code></pre>
</div>
</div>
<div id="profile-prs" class="section level1" number="3">
<h1><span class="header-section-number">3</span> profile PRS</h1>
<p>We profiled PRS from the annotated VCF files with all the SBayesRC
predictors.</p>
<pre class="bash"><code>i=$SLURM_ARRAY_TASK_ID
traitfile=&quot;/QRISdata/Q6913/GCTB_predictor_list_for_batch_profiling.txt&quot;
trait=$(sed &quot;${i}q;d&quot; $traitfile | awk &#39;{print $1}&#39; )
predictor=$(sed  &quot;${i}q;d&quot;  $traitfile  | awk &#39;{print $3}&#39; )
outdir=PRS_all_GCTB
mkdir -p $outdir
samples=(&quot;NA06997&quot; &quot;NA07029&quot; &quot;NA10861&quot;)
for sample in &quot;${samples[@]}&quot;; do
  cohort=${sample}_WGS
  input=${sample}_combined_SBRC_SNPs.vcf
  plink \
   --vcf  $input \
   --double-id  \
   --score  $predictor  2 5 8  header sum    \
   --out ${outdir}/${cohort}_${trait}_SBayesRC
done</code></pre>
<p>The PGS were merged together for each sample.</p>
<pre class="bash"><code>
outdir=PRS_all_GCTB
samples=(&quot;NA06997&quot; &quot;NA07029&quot; &quot;NA10861&quot;)

for sample in &quot;${samples[@]}&quot;; do
  grep ${sample}  ${outdir}/*profile | \
  sed &quot;s/${outdir}\/${sample}_WGS_//&quot; | \
  sed &#39;s/_SBayesRC.profile://&#39;  | \
  awk &#39;{print $1, $5, $6, $7}&#39;  \
  &gt; ${sample}_WGS_PRS_vGCTB.txt
done
</code></pre>
<p>Then the three files are merged into one.</p>
<pre class="r"><code>wgs.sample.list = c(&quot;NA07029&quot; , &quot;NA06997&quot;, &quot;NA10861&quot;)
merged.wgs.prs = data.frame()
for (i in 1:length(wgs.sample.list)){
  sample.id = wgs.sample.list[i]
  wgs.prs= read.table(paste0(&quot;Data/WGS/&quot;, sample.id , &quot;_WGS_PRS_vGCTB.txt&quot;))
  colnames(wgs.prs) = c(&quot;Trait&quot;  , paste0(sample.id, c(&quot;_CNT&quot;, &quot;_CNT2&quot;, &quot;&quot;  ) ) )
 if (nrow(merged.wgs.prs) == 0) {  # Initialize merged.wgs.prs with the first file&#39;s data
    merged.wgs.prs = wgs.prs
  } else {
    merged.wgs.prs = merge(merged.wgs.prs, wgs.prs, by = &quot;Trait&quot;, all = TRUE)
  }
}
row.names(merged.wgs.prs) = merged.wgs.prs$Trait
merged.wgs.prs = merged.wgs.prs[,-1]
write.csv(merged.wgs.prs, file = &quot;Data/WGS/WGS_merged_GCTB_PRS.csv&quot;)</code></pre>
</div>
<div id="snp-coverage" class="section level1" number="4">
<h1><span class="header-section-number">4</span> SNP coverage</h1>
<p>When we profile PGS using plink, the SNPs in predictors but not
target genotype data will be put into a nopred file. We checked these
SNPs across the three samples.</p>
<pre class="r"><code>library(VennDiagram)
a = read.table(&quot;Data/nopred/NA06997_WGS_ADHD_01_SBayesRC.nopred&quot;)
b = read.table(&quot;Data/nopred/NA07029_WGS_ADHD_01_SBayesRC.nopred&quot;)
c = read.table(&quot;Data/nopred/NA10861_WGS_ADHD_01_SBayesRC.nopred&quot;)

# Create a Venn diagram
venn.plot &lt;- venn.diagram(
  x = list(
    Vector1 = a$V2,
    Vector2 = b$V2,
    Vector3 = c$V2
  ),
  category.names = c(&quot;NA06997&quot;, &quot;NA07029&quot;, &quot;NA10861&quot;),
  filename = NULL,  # Use NULL to display the diagram in RStudio
  output = TRUE
)

grid.newpage()
grid.draw(venn.plot)</code></pre>
<p><img src="Figures/fig_wgs_missing_SNPs_overlap.png" /></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
